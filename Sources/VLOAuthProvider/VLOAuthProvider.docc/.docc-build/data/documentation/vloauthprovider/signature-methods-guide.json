{"abstract":[{"type":"text","text":"Understanding and choosing the right OAuth signature method for your application."}],"metadata":{"role":"article","roleHeading":"Article","title":"Signature Methods Guide"},"seeAlsoSections":[{"title":"Related Documentation","anchor":"Related-Documentation","identifiers":["doc:\/\/com.jameslangdon.VLOAuthProvider\/documentation\/VLOAuthProvider\/OAuth-Fundamentals"]}],"primaryContentSections":[{"content":[{"anchor":"Overview","type":"heading","text":"Overview","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"OAuth 1.0 supports three signature methods, each with different security characteristics and implementation requirements. VLOAuthProvider supports all three methods through the "},{"type":"codeVoice","code":"OAuthSignatureMethod"},{"type":"text","text":" enumeration."}]},{"type":"heading","level":2,"text":"HMAC-SHA1 Signature Method","anchor":"HMAC-SHA1-Signature-Method"},{"type":"paragraph","inlineContent":[{"text":"The most commonly used OAuth signature method.","type":"text"}]},{"type":"heading","level":3,"text":"How It Works","anchor":"How-It-Works"},{"type":"paragraph","inlineContent":[{"type":"text","text":"HMAC-SHA1 uses a hash-based message authentication code with the SHA-1 algorithm. It combines your consumer secret and token secret to create a signing key."}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Signing Key Format"}]},{"type":"text","text":": "},{"type":"codeVoice","code":"consumer_secret&token_secret"}]},{"type":"heading","level":3,"text":"Usage","anchor":"Usage"},{"type":"codeListing","syntax":"swift","code":["let parameters = OAuthParameters(","    consumerKey: \"your-consumer-key\",","    consumerSecret: \"your-consumer-secret\",","    signatureMethod: .hmac",")"]},{"type":"paragraph","inlineContent":[{"text":"For requests with access tokens:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["let parameters = OAuthParameters(","    consumerKey: \"your-consumer-key\",","    consumerSecret: \"your-consumer-secret\",","    requestToken: \"access-token\",","    requestSecret: \"access-token-secret\",","    signatureMethod: .hmac",")"]},{"type":"heading","level":3,"text":"Security Characteristics","anchor":"Security-Characteristics"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"✅ ","type":"text"},{"inlineContent":[{"type":"text","text":"High Security"}],"type":"strong"},{"text":": Cryptographically secure","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"✅ "},{"inlineContent":[{"text":"Widely Supported","type":"text"}],"type":"strong"},{"type":"text","text":": Accepted by all OAuth 1.0 services"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"✅ "},{"type":"strong","inlineContent":[{"type":"text","text":"Performance"}]},{"type":"text","text":": Fast computation"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"✅ ","type":"text"},{"inlineContent":[{"type":"text","text":"Transport"}],"type":"strong"},{"text":": Works over HTTP or HTTPS","type":"text"}]}]}]},{"type":"heading","text":"When to Use","level":3,"anchor":"When-to-Use"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Most applications"}],"type":"strong"},{"text":": Default choice for OAuth 1.0","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Production systems"}]},{"type":"text","text":": Reliable and secure"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Service compatibility"}],"type":"strong"},{"text":": When maximum compatibility is needed","type":"text"}],"type":"paragraph"}]}]},{"type":"heading","text":"PLAINTEXT Signature Method","level":2,"anchor":"PLAINTEXT-Signature-Method"},{"type":"paragraph","inlineContent":[{"type":"text","text":"A simple signature method that uses raw secrets without cryptographic hashing."}]},{"type":"heading","text":"How It Works","level":3,"anchor":"How-It-Works"},{"type":"paragraph","inlineContent":[{"type":"text","text":"PLAINTEXT simply concatenates the consumer secret and token secret with an ampersand. No hashing or encryption is performed."}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Signature Format"}],"type":"strong"},{"text":": ","type":"text"},{"code":"consumer_secret&token_secret","type":"codeVoice"}]},{"type":"heading","text":"Usage","level":3,"anchor":"Usage"},{"syntax":"swift","type":"codeListing","code":["let parameters = OAuthParameters(","    consumerKey: \"your-consumer-key\",","    consumerSecret: \"your-consumer-secret\",","    signatureMethod: .plaintext",")"]},{"type":"heading","text":"Security Characteristics","level":3,"anchor":"Security-Characteristics"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"⚠️ "},{"type":"strong","inlineContent":[{"text":"Low Security","type":"text"}]},{"type":"text","text":": Secrets transmitted in plaintext"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"⚠️ ","type":"text"},{"inlineContent":[{"text":"HTTPS Required","type":"text"}],"type":"strong"},{"text":": Must use secure transport","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"✅ ","type":"text"},{"type":"strong","inlineContent":[{"text":"Performance","type":"text"}]},{"text":": Fastest method","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"✅ ","type":"text"},{"inlineContent":[{"type":"text","text":"Debugging"}],"type":"strong"},{"text":": Easy to inspect and verify","type":"text"}]}]}]},{"type":"heading","text":"When to Use","level":3,"anchor":"When-to-Use"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Development\/Testing"}],"type":"strong"},{"type":"text","text":": Easy debugging and verification"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"HTTPS Environments","type":"text"}]},{"type":"text","text":": When secure transport is guaranteed"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Performance Critical"}]},{"type":"text","text":": When minimal computational overhead is required"}]}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"⚠️ Warning"}],"type":"strong"},{"text":": Never use PLAINTEXT over unencrypted HTTP connections.","type":"text"}]},{"type":"heading","text":"RSA-SHA1 Signature Method","level":2,"anchor":"RSA-SHA1-Signature-Method"},{"type":"paragraph","inlineContent":[{"type":"text","text":"A public key cryptography signature method using RSA keys with SHA-1 hashing."}]},{"type":"heading","text":"How It Works","level":3,"anchor":"How-It-Works"},{"type":"paragraph","inlineContent":[{"text":"RSA-SHA1 uses your private RSA key to sign the signature base string. The service provider uses your public key to verify the signature.","type":"text"}]},{"type":"heading","text":"Setup","level":3,"anchor":"Setup"},{"type":"paragraph","inlineContent":[{"type":"text","text":"First, generate an RSA key pair:"}]},{"syntax":"bash","type":"codeListing","code":["# Generate private key","openssl genrsa -out private_key.pem 2048","","# Extract public key  ","openssl rsa -in private_key.pem -pubout -out public_key.pem"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Register your public key with the OAuth service provider, then use the private key for signing:"}]},{"syntax":"swift","type":"codeListing","code":["let privateKeyPEM = \"\"\"","-----BEGIN PRIVATE KEY-----","MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...","-----END PRIVATE KEY-----","\"\"\"","","var parameters = OAuthParameters(","    consumerKey: \"your-consumer-key\",","    consumerSecret: \"not-used-for-rsa\",","    signatureMethod: .rsa",")","parameters.rsaPrivateKey = privateKeyPEM"]},{"type":"heading","text":"Security Characteristics","level":3,"anchor":"Security-Characteristics"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"✅ "},{"type":"strong","inlineContent":[{"text":"Highest Security","type":"text"}]},{"type":"text","text":": Public key cryptography"}]}]},{"content":[{"inlineContent":[{"text":"✅ ","type":"text"},{"type":"strong","inlineContent":[{"text":"Non-repudiation","type":"text"}]},{"text":": Signatures can’t be forged","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"✅ "},{"type":"strong","inlineContent":[{"text":"Key Management","type":"text"}]},{"type":"text","text":": No shared secrets"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"⚠️ ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"Complexity"}]},{"text":": Requires key pair management","type":"text"}]}]}]},{"type":"heading","text":"When to Use","level":3,"anchor":"When-to-Use"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Enterprise Applications","type":"text"}]},{"type":"text","text":": When highest security is required"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"PKI Environments"}],"type":"strong"},{"text":": When you have existing key management","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Long-term Credentials"}]},{"text":": When key rotation is well-managed","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"High-value Transactions"}],"type":"strong"},{"text":": When non-repudiation is important","type":"text"}]}]}]},{"type":"heading","text":"Choosing the Right Method","level":2,"anchor":"Choosing-the-Right-Method"},{"type":"heading","text":"Decision Matrix","level":3,"anchor":"Decision-Matrix"},{"type":"table","rows":[[[{"inlineContent":[{"text":"Factor","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"HMAC-SHA1"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"PLAINTEXT"}]}],[{"type":"paragraph","inlineContent":[{"text":"RSA-SHA1","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Security Level","type":"text"}]}]}],[{"type":"paragraph","inlineContent":[{"text":"High","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Low","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Highest"}]}]],[[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Implementation Complexity"}],"type":"strong"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Low"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Lowest"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"High"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Performance","type":"text"}]}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Fast"}]}],[{"type":"paragraph","inlineContent":[{"text":"Fastest","type":"text"}]}],[{"inlineContent":[{"text":"Slow","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Key Management"}]}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Simple"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Simple"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Complex"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Transport Requirements"}]}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Any"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"HTTPS Only"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Any","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Service Support"}],"type":"strong"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Universal","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Most"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Limited"}],"type":"paragraph"}]]],"header":"row"},{"type":"heading","text":"Recommendations","level":3,"anchor":"Recommendations"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"For Most Applications","type":"text"}]},{"type":"text","text":": Use "},{"type":"strong","inlineContent":[{"type":"text","text":"HMAC-SHA1"}]}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Good security with simple implementation","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Universal service provider support"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Reasonable performance characteristics"}]}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"For Development\/Testing","type":"text"}],"type":"strong"},{"text":": Use ","type":"text"},{"inlineContent":[{"text":"PLAINTEXT","type":"text"}],"type":"strong"},{"text":" (over HTTPS)","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Easy to debug and verify","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Minimal computational overhead","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Quick prototyping"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"For Enterprise\/High-Security","type":"text"}],"type":"strong"},{"text":": Use ","type":"text"},{"inlineContent":[{"type":"text","text":"RSA-SHA1"}],"type":"strong"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Maximum security guarantees"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Non-repudiation of requests","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"When you have PKI infrastructure"}],"type":"paragraph"}]}]},{"type":"heading","text":"Error Handling by Method","level":2,"anchor":"Error-Handling-by-Method"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Different signature methods can produce different errors:"}]},{"syntax":"swift","type":"codeListing","code":["do {","    let signedRequest = try await provider.createSignedRequest(","        from: request,","        with: parameters,","        as: .header","    )","} catch EncryptionError.invalidPrivateKey {","    \/\/ RSA-SHA1 specific: malformed private key","    print(\"Invalid RSA private key format\")","} catch EncryptionError.emptyKey {","    \/\/ All methods: missing consumer secret","    print(\"Consumer secret is required\")","} catch EncryptionError.signingFailed {","    \/\/ Cryptographic operation failed","    print(\"Signature generation failed\")","}"]},{"type":"heading","text":"Performance Considerations","level":2,"anchor":"Performance-Considerations"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Relative performance of signature methods:"}]},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"PLAINTEXT","type":"text"}]},{"type":"text","text":": ~0.01ms (string concatenation only)"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"text":"HMAC-SHA1","type":"text"}],"type":"strong"},{"text":": ~0.1ms (hash computation)","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"RSA-SHA1","type":"text"}]},{"type":"text","text":": ~1-5ms (RSA signing operation)"}]}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"For high-throughput applications, consider the computational cost of signature generation."}]}],"kind":"content"}],"kind":"article","identifier":{"interfaceLanguage":"swift","url":"doc:\/\/com.jameslangdon.VLOAuthProvider\/documentation\/VLOAuthProvider\/Signature-Methods-Guide"},"schemaVersion":{"minor":3,"major":0,"patch":0},"hierarchy":{"paths":[["doc:\/\/com.jameslangdon.VLOAuthProvider\/documentation\/VLOAuthProvider"]]},"sections":[],"references":{"doc://com.jameslangdon.VLOAuthProvider/documentation/VLOAuthProvider/OAuth-Fundamentals":{"abstract":[{"text":"Understanding the OAuth 1.0 authentication protocol and how VLOAuthProvider implements it.","type":"text"}],"title":"OAuth 1.0 Fundamentals","url":"\/documentation\/vloauthprovider\/oauth-fundamentals","role":"article","type":"topic","identifier":"doc:\/\/com.jameslangdon.VLOAuthProvider\/documentation\/VLOAuthProvider\/OAuth-Fundamentals","kind":"article"},"doc://com.jameslangdon.VLOAuthProvider/documentation/VLOAuthProvider":{"kind":"article","role":"collection","type":"topic","url":"\/documentation\/vloauthprovider","title":"VLOAuthProvider","abstract":[],"identifier":"doc:\/\/com.jameslangdon.VLOAuthProvider\/documentation\/VLOAuthProvider"}}}